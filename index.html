<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="The personal site of Luc Dodge Terra—essays at the intersection of arts and science."/>
  <title>Luc Dodge Terra</title>
  <link rel="stylesheet" href="/style.css"/>
  <script>
  (function(){
    try{
      var saved = localStorage.getItem('theme');
      var theme = saved || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.dataset.theme = theme;
    }catch(e){}
  })();

  function updateThemeToggleIcon() {
    var btn = document.querySelector('.theme-toggle');
    if (!btn) return;
    btn.textContent = document.documentElement.dataset.theme === 'dark' ? '☀' : '☾';
  }

  function toggleTheme(){
    var next = document.documentElement.dataset.theme === 'dark' ? 'light' : 'dark';
    document.documentElement.dataset.theme = next;
    try{ localStorage.setItem('theme', next); }catch(e){}
    updateThemeToggleIcon();
  }

  document.addEventListener('DOMContentLoaded', updateThemeToggleIcon);
</script>
</head>
<body>
  <header class="site-header">
    <div class="container brand" style="position:relative">
      <h1><a href="/" style="text-decoration:none; color:inherit">Luc Dodge Terra</a></h1>
      <p>“I'm smart enough to know that I am dumb.”</p>
      <p>- Richard Feynman</p>
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode"></button>
    </div>
    <nav class="container nav">
      <a href="/" class="active">Home</a>
      <a href="/about">About</a>
      <a href="/consumption">Consumption</a>
      <a href="/investment">Investment</a>
      <a href="/producing">Production</a>
    </nav>
  </header>

  <main class="container">
    <p class="centered-text">Welcome to my madness!</p>

    <h2>Recent writing</h2>
    <div id="recent-posts"></div>

    <div class="hr"></div>

    <h2>Projects</h2>
    <div class="card">
      <a class="title" href="#">[Project name]</a>
      <div class="meta">Brief line about what it is.</div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
    </div>
  </footer>

  <script>
    // Load most recent few posts for the homepage
    fetch('/posts/index.json')
      .then(r=>r.json())
      .then(posts=>{
        var el = document.getElementById('recent-posts');
        posts.sort((a,b)=> (b.date||'').localeCompare(a.date));
        posts.slice(0,3).forEach(function(p){
          var d = document.createElement('div'); d.className='card';
          d.innerHTML = `<a class="title" href="${p.url}">${p.title}</a>
            <div class="meta">${p.category} · <time datetime="${p.date}">${new Date(p.date).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'})}</time></div>
            <p>${p.summary||''}</p>`;
          el.appendChild(d);
        });
      })
      .catch(function(){ document.getElementById('recent-posts').innerHTML = '<p class="muted">Add posts to <code>/posts</code> to see them here.</p>';});
  </script>
</body>
</html>
